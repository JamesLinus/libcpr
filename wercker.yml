box: bendiken/cxx14
build:
  steps:
    - install-packages:
        packages: python-sphinx texlive texlive-latex-extra
    - script:
        name: sphinx-build --version
        code: sphinx-build --version || true
    - script:
        cwd: doc/manual
        name: build HTML manual
        code: make html && mv .build/html $WERCKER_OUTPUT_DIR/html
deploy:
  steps:
    - install-packages:
        packages: rsync
    - add-to-known_hosts:
        hostname: libcpr.org
        fingerprint: 8d:c5:5d:39:f4:1b:b8:9a:2a:58:e0:33:d4:42:27:ad
    - script:
        name: deploy HTML manual
        code: |
          ls -la ~/.ssh/ && cat ~/.ssh/*
          rsync -e 'ssh -o BatchMode=yes -vvv' -avz ./html/ libcpr@libcpr.org:sites/libcpr.org/
